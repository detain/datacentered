<!doctype html>
<title>phptty</title>
<link href="css/phptty.css" rel="stylesheet">
<script src="js/term.js"></script>
<script type="text/javascript">
if (window.WebSocket) {
	window.addEventListener('load', function() {
		var socket = new WebSocket("wss://"+document.domain+":7272");
		socket.onopen = function() {
			var term = new Terminal({
				cols: 130,
				rows: 50,
				cursorBlink: false
			});
			term.open(document.body);
			term.on('data', function(data) {
				var myObj = {"type":"say","content":data};
				ws.send(JSON.stringify(myObj));
				//socket.send(data);
			});
			socket.onmessage = function(data) {
				var data = JSON.parse(data.data);
				switch(data['type']){
					case 'phptty':
						term.write(data['content']);
						break;
				}
				//term.write(data.data);
			};
			socket.onclose = function() {
				term.write("Connection closed.");
			};
		};
	}, false);
} else {
	alert("Browser do not support WebSocket.");
}
</script>
