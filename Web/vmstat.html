<!DOCTYPE html>
<title>Stats</title>
<meta charset="utf8">
<link href="css/vmstat.css" rel="stylesheet">
<script src="//my.interserver.net/bower_components/jquery-1.11.x/dist/jquery.min.js" type="text/javascript"></script>
<script src="//my.interserver.net/bower_components/sugar/release/sugar.min.js" type="text/javascript"></script>
<script src="//my.interserver.net/lib/ReconnectingWebSocket/reconnecting-websocket.min.js" type="text/javascript"></script>
<script src="//my.interserver.net/bower_components/smoothie/smoothie.js" type="text/javascript"></script>
<script src="//my.interserver.net/bower_components/chroma-js/chroma.min.js" type="text/javascript"></script>
<script src="js/vmstat.js" type="text/javascript"></script>
<script type="text/javascript">
function streamStats() {
	var ws = new ReconnectingWebSocket("wss://"+document.domain+":7272");
	var colHeadings;
	ws.onopen = function() {
		console.log('connect');
		ws.send('{"type":"login","client_name":"vmstat_client","room_id":"vmstat"}');
	};
	ws.onclose = function() {
		console.log('disconnect');
	};
	ws.onmessage = function(e) {
		//console.log("got message "+e.data);
		var data = JSON.parse(e.data);
		switch(data['type']){
			case 'vmstat':
				receiveStats(data['content']);
				break;
		}
	};
}

$(function() {
	initCharts();
	streamStats();
});
</script>
<main id="charts">
  <section class="chart template">
	<h2 class="title"></h2>
	<canvas style="width:100%; height:80px"></canvas>
	<table class="stat-table">
		<tr class="stats">
			<td class="stat template">
				<span class="stat-name"></span>
				<span class="stat-value"></span>
			</td>
		</tr>
	</table>
  </section>
</main>
